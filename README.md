# **SNNベース AIチャットシステム (v2.7 \- 高次認知アーキテクチャ)**

## **1\. 概要**

本プロジェクトは、スパイキングニューラルネットワーク（SNN）技術を基盤とした、次世代のAIチャットシステムです。最終目標は、自ら思考し、学習し、自己を改良する**自律的デジタル生命体**を創造することにあります。

現在のバージョンでは、システムは以下の主要な能力を持つ**自律エージェント**として動作します。

* **オンデマンド学習:** 未知のタスクに直面した際、大規模言語モデルから知識を蒸留し、タスクに特化した超省エネルギーな「専門家SNN」を自律的に生成します。  
* **自己認識とモデル選択:** 自身の能力（学習済み専門家モデルのリスト）を把握しており、与えられたタスクに対し、エネルギー効率と性能を天秤にかけて最適な専門家を自律的に選択します。  
* **長期記憶:** 全ての思考、判断、行動を時系列で記録する長期記憶システムを備えており、この記憶は将来の自己改良と、後述するRAGシステムの知識源となります。  
* **高次認知:** 複数の専門家SNNとRAG（Retrieval-Augmented Generation）システムを連携させ、複雑なタスクを複数のサブタスクに分解・計画し、実行する高次の問題解決能力を持ちます。

アーキテクチャ全体は、依存性の注入（DI）コンテナを用いて構築されており、研究開発からアプリケーション化までをシームレスに繋ぐ、高い保守性と拡張性を実現しています。

## **2\. 使い方 (How to Use)**

### **ステップ1: 環境設定**

まず、必要なライブラリをインストールします。

pip install \-r requirements.txt

### **ステップ2: 自律エージェントの基本操作**

run\_agent.py は、エージェントに単一のタスクを依頼するための基本的なインターフェースです。

#### **例1: 既存の専門家モデルを選択して推論を実行**

事前に「感情分析」の専門家モデルが学習済みであると仮定します。

python run\_agent.py \\  
    \--task\_description "感情分析" \\  
    \--prompt "この映画は本当に素晴らしかった！"

エージェントはモデル登録簿（runs/model\_registry.json）を調べ、最適な「感情分析」モデルを選択してプロンプトに対する応答を生成します。

#### **例2: 新しい専門家モデルをオンデマンドで学習**

「文章要約」の専門家が存在しない場合、エージェントは自動的に学習を開始します。

python run\_agent.py \\  
    \--task\_description "文章要約" \\  
    \--unlabeled\_data\_path data/sample\_data.jsonl \\  
    \--prompt "SNNは、生物の神経系における情報の伝達と処理のメカニズムを模倣したニューラルネットワークの一種である。"

エージェントは「文章要約」モデルが存在しないことを検知し、data/sample\_data.jsonlを使って新しい専門家の学習を自動的に開始します。学習完了後、そのモデルを使ってプロンプトに対する要約を生成します。

*(Note: 手動で専門家を学習させたい場合は run\_distillation.py を使用することも可能です。)*

### **ステップ3: 高次認知アーキテクチャの実行**

run\_planner.py は、エージェントに複数のステップを要する複雑なタスクを依頼するためのインターフェースです。プランナーは内部でRAGシステムを利用し、自己の知識ベース（ドキュメントや過去の記憶）を参照します。

#### **3.1. 知識ベースの構築 (初回のみ)**

プランナーを実行する前に、RAGシステムが検索するためのベクトル化された知識ベースを構築する必要があります。

python scripts/build\_knowledge\_base.py

このコマンドは doc ディレクトリと runs/agent\_memory.jsonl の内容を読み込み、検索可能なインデックスを runs/vector\_store に作成します。

#### **3.2. 階層的プランナーによる複雑なタスクの実行**

知識ベースの準備ができたら、プランナーに複雑なタスクを依頼できます。

python run\_planner.py \\  
    \--task\_request "この記事を要約して、その内容の感情を分析してください。" \\  
    \--context\_data "SNNは非常にエネルギー効率が高いことで知られているが、その性能はまだANNに及ばない点もある。"

プランナーはタスクを「文章要約」と「感情分析」の2つのサブタスクに分解し、それぞれに対応する専門家を呼び出して、段階的に問題を解決します。もし専門家が見つからない場合は、RAGシステムが検索した関連知識を返します。

### **ステップ4: 対話アプリケーションの起動 (Gradio UI)**

学習済みのモデルと直接対話するためのWeb UIも用意されています。

#### **4.1. 標準チャットUI**

python \-m app.main \--model\_config configs/models/medium.yaml

#### **4.2. LangChain連携チャットUI**

python \-m app.langchain\_main \--model\_config configs/models/medium.yaml

ブラウザで http://0.0.0.0:7860 (LangChain版は 7861\) を開いてください。

## **3\. プロジェクト構造**

* /app: Gradio UIやLangChain連携など、アプリケーション層のコード。  
* /configs: モデルのアーキテクチャや学習パラメータなどの設定ファイル。  
* /data: 学習や評価に使用するサンプルデータ。  
* /doc: プロジェクトの設計書、ロードマップなどのドキュメント。  
* /runs: 学習済みモデル、ログ、モデル登録簿、ベクトルストアなど、実行時に生成されるファイル。  
* /scripts: データ準備や知識ベース構築など、補助的なスクリプト。  
* /snn\_research: SNNのコアロジック、学習パイプライン、認知アーキテクチャなど、研究開発の中核をなすコード。

## **4\. ロードマップ**

本プロジェクトは、**自律的デジタル生命体の創造**という壮大な目標に向け、以下のロードマップに沿って開発を進めています。詳細は doc/ROADMAP.md を参照してください。

* **Phase 0-2 (完了):** 基礎となるSNNアーキテクチャ、学習基盤、自律エージェントの枠組みを構築。  
* **Phase 3 (進行中):** 階層的プランナー、グローバル・ワークスペース、RAG-SNNを統合し、高次認知能力を獲得。  
* **Phase 4 (次):** 経験を通じて自己の構造を動的に変化させる、パフォーマンス駆動型の自己進化メカニズムを実装。  
* **Phase 5以降:** 自己参照によるコードの自動修正、内的な動機付け、そして「心」の創発を目指す。
